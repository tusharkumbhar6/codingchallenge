def cron_to_row(cron_expr: str) -> str:
    weekday_map = {
        "0": "Sunday", "1": "Monday", "2": "Tuesday",
        "3": "Wednesday", "4": "Thursday",
        "5": "Friday", "6": "Saturday", "7": "Sunday"
    }

    parts = cron_expr.split()
    if len(parts) != 5:
        return None  # skip invalid lines

    minute, hour, date, month, weekday = parts

    # Convert weekday to readable text
    if weekday == "*":
        day_readable = "every"
    else:
        if "," in weekday:
            day_readable = "Every " + ", ".join(weekday_map[w] for w in weekday.split(","))
        elif "-" in weekday:
            start, end = weekday.split("-")
            day_readable = f"Every {weekday_map[start]} to {weekday_map[end]}"
        else:
            day_readable = f"Every {weekday_map.get(weekday, weekday)}"

    return f"{cron_expr}, {minute}, {hour}, {date}, {month}, {day_readable}"


# ----------------------------
# Read cron expressions from file
# ----------------------------
input_file = "crons.txt"      # change as needed
output_file = "cron_output.csv"  # optional output file

print("cronschedule, min, hours, date, month, day")

rows = []
with open(input_file, "r") as f:
    for line in f:
        cron = line.strip()
        if not cron:
            continue  # skip empty lines

        result = cron_to_row(cron)
        if result:
            print(result)
            rows.append(result)

# ----------------------------
# Optional: write output to CSV file
# ----------------------------
with open(output_file, "w") as out:
    out.write("cronschedule, min, hours, date, month, day\n")
    for row in rows:
        out.write(row + "\n")
