from ldap3 import Server, Connection, NTLM, SUBTREE, ALL

server = Server("ldap://YOUR_SERVER", get_info=ALL)
conn = Connection(server, user="DOMAIN\\bindUser", password="xxxx", authentication=NTLM)
conn.bind()

base_dn = "DC=reg1,DC=org,DC=my_company,DC=com"
fid = "YOUR_FID_HERE"   # Example: fid_xyz

# Query the Functional ID
conn.search(
    search_base=base_dn,
    search_filter=f"(&(objectClass=user)(sAMAccountName={fid}))",
    search_scope=SUBTREE,
    attributes="*"
)

entry = conn.entries[0]

# Print each attribute in clean format
for attr in entry.entry_attributes:
    value = entry[attr].value
    print(f"{attr}: {value if value else 'NULL'}")
